<script>
  // Needed to activate tooltips.
  $(function () {
    $('[data-toggle="tooltip"]').tooltip()
  })
  $(function () {
    $('[data-toggle="popover"]').popover()
  })
</script>

<%= form_for @submission, html: { multipart: true } do |f| %>
  <div class="row">
  <div class="col-lg-6">
	  
	  <div class="card">
	    <div class="card-header"><b>New Submission (<span style="font-weight:600;">bolded</span> fields are required)</b></div>
      <div class="card-body">
    
        <% if @submission.errors.any? %>
          <div id="error_explanation">
            <h3><%= pluralize(@submission.errors.count, "error") %> prohibited this submission from being posted:</h3>
            <ul>
              <% @submission.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        
        By submitting, you agree to the submission guidelines and content policy as specified <a href="../help">here</a>.<br><br>

        <div class="form-group row">
          <div class="col-3" style="font-weight:600;">
            <%= f.label :drawing %><br>
          </div>
          <div class="col-9">
            <%= f.file_field :drawing %>
          </div>
        </div>

        <div class="form-group row">
          <div class="col-3" style="font-weight:600;">
            <%= f.label :nsfw_level %>
          </div>
          <div class="col-9">
            <%= f.select :nsfw_level, options_for_select([['Safe', 1], ['Questionable', 2], ['Explicit', 3]], 1), {}, { :class => 'custom-select' } %>
          </div>
        </div>
        
        <div class="form-group row">
          <div class="col-3">
            <%= f.label :title %>
          </div>
          <div class="col-9">
            <%= f.text_field :title %>
          </div>
        </div>
        
        <div class="form-group row">
          <div class="col-3">
            <%= f.label :description %>
          </div>
          <div class="col-9">
            <%= f.text_area :description %>
          </div>
        </div>
        
        <div class="form-group row">
          <div class="col-6">
            <%= f.label :time, "Time Spent (in minutes)" %>
          </div>
          <div class="col-6">
            <%= f.number_field :time, :max => 2880 %>
          </div>
        </div>
        
        <div class="form-group row">
          <div class="col-6">
            <%= f.label :commentable, "Allow Comments?" %>
          </div>
          <div class="col-6">
            <%= f.check_box :commentable, :checked => @submission.commentable %>
          </div>
        </div>

        <div class="form-group row">
          <div class="offset-sm-6 col-sm-6">
            <%= f.submit :class => 'btn btn-primary', :style => "margin-bottom: 0;" %>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  
  
  
  <div class="col-lg-6">
    
    <div class="card">
      <div class="card-header"><b>Eligible Challenges</b></div>
      <div class="card-body">
        <p class="card-text">
          You can submit to the following challenges. All submissions are entered into the Do Art Daily and current seasonal challenge.
          <br>
          <small style="color: grey;">(<b>You can increase your frequency, but lowering your post frequency will reset your streak!</b>)</small>
          <div class="form-group row" style="margin-bottom: 0;">
            <div class="col-3">
              <%= label_tag :postfrequency, "DAD Post Frequency" %>
            </div>
            <div class="col-9">
              <%= select_tag :postfrequency, options_for_select([['Daily', 1], ['Every Other Day', 2], ['Every 3 Days', 3], ['Every 4 Days', 4], ['Every 5 Days', 5], ['Every 6 Days', 6], ['Weekly', 7]], (getUserDADFrequency(current_user) == 0 ? 1 : getUserDADFrequency(current_user) )), { :class => 'custom-select' } %>
            </div>
          </div>
          
          <div class="form-group row">
            <div class="col-3">
              Seasonal Challenge:
            </div>
            <div class="col-9">
              <%= getCurrentSeasonalChallenge.name %>
            </div>
          </div>
          <br>
          <b>Custom Challenges:</b><br>
          <small><b>Remember to double check that you've submitted to all relevant challenges, and that your submission fulfills the conditions required for the challenge.</b></small>
          <% @participations.each do |p| %>
            <% if p.challenge.id != 1 && !p.challenge.seasonal %>
              <div class="form-group row">
                <div class="col-3">
                  <%= label_tag p.challenge_id, "#{p.challenge.name}" %>
                </div>
                <div class="col-3">
                  <%= check_box_tag p.challenge_id, 1, !ChallengeEntry.find_by({:challenge_id => p.challenge_id, :submission_id => @submission.id}).blank? %>
                </div>
                <div class="col-6">
                </div>
              </div>
            <% end %>
          <% end %>
        </p>
      </div>
    </div>
    
  </div>
  </div>
<% end %>
